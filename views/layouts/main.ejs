<!DOCTYPE html>
<html lang="en" data-theme="<%= theme || 'dark' %>">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %> | Fusion CMS</title>
  
  <!-- Tailwind CSS -->
  <link href="/css/tailwind.output.css" rel="stylesheet">
  
  <!-- Custom CSS -->
  <link href="/css/styles.css" rel="stylesheet">
  
  <!-- Font (Inter) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
  
  <!-- Style section for dynamically injected CSS -->
  <%- style %>
  
  <!-- Theme styles -->
  <style>
    :root {
      --background: 0 0% 100%;
      --foreground: 224 71.4% 4.1%;
      --card: 0 0% 100%;
      --card-foreground: 224 71.4% 4.1%;
      --popover: 0 0% 100%;
      --popover-foreground: 224 71.4% 4.1%;
      --primary: 262.1 83.3% 57.8%;
      --primary-foreground: 210 20% 98%;
      --secondary: 220 14.3% 95.9%;
      --secondary-foreground: 220.9 39.3% 11%;
      --muted: 220 14.3% 95.9%;
      --muted-foreground: 220 8.9% 46.1%;
      --accent: 220 14.3% 95.9%;
      --accent-foreground: 220.9 39.3% 11%;
      --destructive: 0 84.2% 60.2%;
      --destructive-foreground: 210 20% 98%;
      --border: 220 13% 91%;
      --input: 220 13% 91%;
      --ring: 262.1 83.3% 57.8%;
      --radius: 0.5rem;
    }

    [data-theme="dark"] {
      --background: 224 71.4% 4.1%;
      --foreground: 210 20% 98%;
      --card: 224 71.4% 4.1%;
      --card-foreground: 210 20% 98%;
      --popover: 224 71.4% 4.1%;
      --popover-foreground: 210 20% 98%;
      --primary: 263.4 70% 50.4%;
      --primary-foreground: 210 20% 98%;
      --secondary: 215 27.9% 16.9%;
      --secondary-foreground: 210 20% 98%;
      --muted: 215 27.9% 16.9%;
      --muted-foreground: 217.9 10.6% 64.9%;
      --accent: 215 27.9% 16.9%;
      --accent-foreground: 210 20% 98%;
      --destructive: 0 62.8% 30.6%;
      --destructive-foreground: 210 20% 98%;
      --border: 215 27.9% 16.9%;
      --input: 215 27.9% 16.9%;
      --ring: 263.4 70% 50.4%;
    }
  </style>
</head>
<body class="bg-background text-foreground font-sans min-h-screen">
  <% if (typeof flash !== 'undefined' && flash) { %>
    <% if (flash.success && flash.success.length > 0) { %>
      <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative" role="alert">
        <strong class="font-bold">Success!</strong>
        <span class="block sm:inline"><%= flash.success %></span>
      </div>
    <% } %>
    <% if (flash.error && flash.error.length > 0) { %>
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
        <strong class="font-bold">Error!</strong>
        <span class="block sm:inline"><%= flash.error %></span>
      </div>
    <% } %>
    <% if (flash.info && flash.info.length > 0) { %>
      <div class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded relative" role="alert">
        <strong class="font-bold">Info!</strong>
        <span class="block sm:inline"><%= flash.info %></span>
      </div>
    <% } %>
    <% if (flash.warning && flash.warning.length > 0) { %>
      <div class="bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded relative" role="alert">
        <strong class="font-bold">Warning!</strong>
        <span class="block sm:inline"><%= flash.warning %></span>
      </div>
    <% } %>
    <% if (flash.message && typeof flash.message === 'string') { %>
      <div class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded relative" role="alert">
        <strong class="font-bold"><%= flash.type || 'Info' %>!</strong>
        <span class="block sm:inline"><%= flash.message %></span>
      </div>
    <% } else if (flash.message && Array.isArray(flash.message) && flash.message.length > 0) { %>
      <div class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded relative" role="alert">
        <strong class="font-bold"><%= flash.type || 'Info' %>!</strong>
        <span class="block sm:inline"><%= flash.message[0] %></span>
      </div>
    <% } %>
  <% } %>

  <div id="app" class="min-h-screen flex flex-col">
    <%- include('../partials/header') %>
    <%- include('../partials/toast') %>
    
    <main class="flex-grow">
      <%- body %>
    </main>
    
    <%- include('../partials/footer') %>
  </div>

  <!-- Scripts -->
  <script src="/js/main.js"></script>
  
  <!-- Script section for dynamically injected JavaScript -->
  <%- script %>
</body>
</html>
